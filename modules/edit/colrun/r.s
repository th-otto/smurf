do_colrun:
    movem.l    d3-d6/a2-a5,-(a7)
    lea.l      -152(a7),a7
    move.l     a0,108(a7)
    movea.l    a1,a2
    move.w     d0,d4
    clr.w      62(a7)
    movea.l    302(a2),a3
    move.w     310(a2),2(a7)
    move.w     312(a2),(a7)
    clr.w      d6
    lea.l      64(a7),a4
    bra.s      $000106FA
    move.w     d6,d0
    add.w      d0,d0
    move.w     d6,0(a4,d0.w)
    addq.w     #1,d6
    cmp.w      #$0010,d6
    blt.s      $000106F0
    clr.w      d6
    bra.s      $0001074C
    clr.w      d0
    bra.s      $0001073E
    move.w     d0,d1
    add.w      d1,d1
    move.w     2(a4,d1.w),d2
    lea.l      $00014257,a0
    move.b     0(a0,d2.w),d1
    move.w     d0,d2
    add.w      d2,d2
    move.w     0(a4,d2.w),d2
    cmp.b      0(a0,d2.w),d1
    bcc.s      $0001073C
    move.w     d2,d1
    move.w     d0,d2
    add.w      d2,d2
    move.w     d0,d3
    add.w      d3,d3
    move.w     2(a4,d2.w),0(a4,d3.w)
    move.w     d1,2(a4,d2.w)
    addq.w     #1,d0
    moveq.l    #-1,d1
    add.w      num_datapoints,d1
    cmp.w      d1,d0
    blt.s      $00010708
    addq.w     #1,d6
    moveq.l    #-1,d0
    add.w      num_datapoints,d0
    cmp.w      d0,d6
    blt.s      $00010704

    moveq.l    #1,d1
    movea.l    $00013A4A,a0 maintree
    and.w      130(a0),d1
    beq        $00010856

    lea.l      112(a7),a0
    move.w     d4,d0
    bsr        _wxcnv
    lea.l      112(a7),a0
    lea.l      $0001392E,a1
    bsr        _xxmul
    lea.l      112(a7),a0
    lea.l      $00013938,a1
    bsr        __xxdiv
    lea.l      122(a7),a0
    move.l     -(a0),-(a7)
    move.l     -(a0),-(a7)
    move.w     -(a0),-(a7)
    pea.l      122(a7)
    bsr        cos
    lea.l      14(a7),a7
    lea.l      122(a7),a0
    move.l     -(a0),-(a7)
    move.l     -(a0),-(a7)
    move.w     -(a0),-(a7)
    pea.l      122(a7)
    bsr        fabs
    lea.l      14(a7),a7

    lea.l      122(a7),a0
    move.w     d4,d0
    bsr        _wxcnv
    lea.l      122(a7),a0
    lea.l      $00013942,a1
    bsr        _xxmul
    lea.l      122(a7),a0
    lea.l      $0001394C,a1
    bsr        __xxdiv
    lea.l      132(a7),a0
    move.l     -(a0),-(a7)
    move.l     -(a0),-(a7)
    move.w     -(a0),-(a7)
    pea.l      132(a7)
    bsr        sin
    lea.l      14(a7),a7
    lea.l      132(a7),a0
    move.l     -(a0),-(a7)
    move.l     -(a0),-(a7)
    move.w     -(a0),-(a7)
    pea.l      132(a7)
    bsr        fabs
    lea.l      14(a7),a7

    lea.l      132(a7),a0
    move.w     310(a2),d0
    bsr        _wxcnv
    lea.l      132(a7),a0
    lea.l      112(a7),a1
    bsr        _xxmul
    lea.l      142(a7),a0
    move.w     312(a2),d0
    bsr        _wxcnv
    lea.l      142(a7),a0
    lea.l      122(a7),a1
    bsr        _xxmul
    lea.l      132(a7),a0
    lea.l      142(a7),a1
    bsr        __xxadd
    lea.l      132(a7),a0
    bsr        _xlcnv
    move.l     d0,d3
    bra        $000109E4

    clr.w      d0
    sub.w      $00014268,d0 mx
    ext.l      d0
    clr.w      d1
    sub.w      $00014268,d1 mx
    ext.l      d1
    bsr        _lmul
    move.l     d0,8(a7)
    clr.w      d0
    sub.w      $0001426A,d0 my
    ext.l      d0
    clr.w      d1
    sub.w      $0001426A,d1 my
    ext.l      d1
    bsr        _lmul
    move.l     d0,4(a7)
    move.l     8(a7),d1
    add.l      d0,d1
    lea.l      112(a7),a0
    move.l     d1,d0
    bsr        _lxcnv
    lea.l      122(a7),a0
    move.l     -(a0),-(a7)
    move.l     -(a0),-(a7)
    move.w     -(a0),-(a7)
    pea.l      132(a7)
    bsr        sqrt
    lea.l      14(a7),a7
    lea.l      122(a7),a0
    bsr        _xlcnv
    move.l     d0,d0
    move.l     d0,16(a7)

    move.w     (a7),d0
    sub.w      $0001426A,d0 my
    ext.l      d0
    move.w     (a7),d1
    sub.w      $0001426A,d1 my
    ext.l      d1
    bsr        _lmul
    move.l     d0,4(a7)
    move.l     8(a7),d1
    add.l      d0,d1
    lea.l      112(a7),a0
    move.l     d1,d0
    bsr        _lxcnv
    lea.l      122(a7),a0
    move.l     -(a0),-(a7)
    move.l     -(a0),-(a7)
    move.w     -(a0),-(a7)
    pea.l      132(a7)
    bsr        sqrt
    lea.l      14(a7),a7
    lea.l      122(a7),a0
    bsr        _xlcnv
    move.l     d0,d5
    move.w     2(a7),d0
    sub.w      $00014268,d0 mx
    ext.l      d0
    move.w     2(a7),d1
    sub.w      $00014268,d1 mx
    ext.l      d1
    bsr        _lmul
    move.l     d0,8(a7)
    clr.w      d0
    sub.w      $0001426A,d0 my
    ext.l      d0
    clr.w      d1
    sub.w      $0001426A,d1 my
    ext.l      d1
    bsr        _lmul
    move.l     d0,4(a7)
    move.l     8(a7),d1
    add.l      d0,d1
    lea.l      112(a7),a0
    move.l     d1,d0
    bsr        _lxcnv
    lea.l      122(a7),a0
    move.l     -(a0),-(a7)
    move.l     -(a0),-(a7)
    move.w     -(a0),-(a7)
    pea.l      132(a7)
    bsr        sqrt
    lea.l      14(a7),a7

    lea.l      122(a7),a0
    bsr        _xlcnv
    move.l     d0,d0
    move.l     d0,12(a7)
    move.w     (a7),d0
    sub.w      $0001426A,d0 my
    ext.l      d0
    move.w     (a7),d1
    sub.w      $0001426A,d1 my
    ext.l      d1
    bsr        _lmul
    move.l     d0,4(a7)
    move.l     8(a7),d1
    add.l      d0,d1
    lea.l      112(a7),a0
    move.l     d1,d0
    bsr        _lxcnv
    lea.l      122(a7),a0
    move.l     -(a0),-(a7)
    move.l     -(a0),-(a7)
    move.w     -(a0),-(a7)
    pea.l      132(a7)
    bsr        sqrt
    lea.l      14(a7),a7
    lea.l      122(a7),a0
    bsr        _xlcnv
    move.l     d0,d1

    move.l     16(a7),d3
    cmp.l      d5,d3
    bge.s      $000109D4
    move.l     d5,d3
    cmp.l      12(a7),d3
    bge.s      $000109DE
    move.l     12(a7),d3
    cmp.l      d1,d3
    bge.s      $000109E4
    move.l     d1,d3

    lea.l      $00013956,a0
    lea.l      122(a7),a1
    move.l     (a0)+,(a1)+
    move.l     (a0)+,(a1)+
    move.w     (a0)+,(a1)+
    lea.l      122(a7),a0
    move.l     d3,d0
    bsr        _xldiv

    move.l     d3,d0
    add.l      d0,d0
    add.l      d3,d0
    add.l      #$00000800,d0
    movea.l    108(a7),a0
    movea.l    82(a0),a1
    movea.l    56(a1),a0
    jsr        (a0)

    movea.l    a0,a5
    move.l     a0,98(a7)

    clr.w      d6
    bra.s      $00010A3C
    move.b     datapoint_red,0(a5,d6.w)
    move.b     datapoint_green,1(a5,d6.w)
    move.b     datapoint_blue,2(a5,d6.w)
    addq.w     #3,d6
    move.w     d6,d0
    ext.l      d0
    move.l     d0,-(a7)
    move.l     d1,-(a7)
    move.l     d3,d0
    moveq.l    #2,d1
    bsr        _ldiv
    move.l     (a7)+,d1
    move.l     d0,d1
    add.l      d1,d1
    add.l      d0,d1
    move.l     (a7)+,d2
    cmp.l      d1,d2
    blt.s      $00010A22

    move.l     d1,d6
    bra.s      $00010A96
    move.w     num_datapoints,d0
    lea.l      datapoint_red,a0
    move.b     -1(a0,d0.w),0(a5,d6.w)
    move.w     num_datapoints,d0
    lea.l      datapoint_green,a1
    move.b     -1(a1,d0.w),1(a5,d6.w)
    move.w     num_datapoints,d0
    lea.l      datapoint_blue,a0
    move.b     -1(a0,d0.w),2(a5,d6.w)
    addq.w     #3,d6
    move.w     d6,d0
    ext.l      d0
    move.l     d3,d1
    add.l      d1,d1
    add.l      d3,d1
    add.l      #$00000400,d1
    cmp.l      d1,d0
    blt.s      $00010A5E

    lea.l      1024(a5),a5
    clr.w      62(a7)
    bra        $00010C16
    move.w     62(a7),d0
    add.w      d0,d0
    move.w     0(a4,d0.w),60(a7)
    move.w     2(a4,d0.w),d5

    move.w     60(a7),d1
    lea.l      datapoint_red,a0
    moveq.l    #0,d2
    move.b     0(a0,d1.w),d2
    moveq.l    #10,d6
    lsl.l      d6,d2
    move.l     d2,56(a7)

    lea.l      datapoint_green,a1
    moveq.l    #0,d6
    move.b     0(a1,d1.w),d6
    moveq.l    #10,d0
    lsl.l      d0,d6

    lea.l      datapoint_blue,a0
    moveq.l    #0,d2
    move.b     0(a0,d1.w),d2
    lsl.l      d0,d2
    move.l     d2,52(a7)

    lea.l      $00014257,a1
    clr.w      d2
    move.b     0(a1,d1.w),d2
    lea.l      112(a7),a0
    move.w     d2,d0
    bsr        _wxcnv
    lea.l      112(a7),a0
    lea.l      122(a7),a1
    bsr        __xxdiv
    lea.l      112(a7),a0
    bsr        _xlcnv
    move.w     d0,d0
    move.w     d0,104(a7)

    lea.l      $00014257,a0
    clr.w      d1
    move.b     0(a0,d5.w),d1
    lea.l      112(a7),a0
    move.w     d1,d0
    bsr        _wxcnv
    lea.l      112(a7),a0
    lea.l      122(a7),a1
    bsr        __xxdiv
    lea.l      112(a7),a0
    bsr        _xlcnv
    move.w     d0,d0
    move.w     d0,102(a7)

    lea.l      datapoint_red,a0
    moveq.l    #0,d0
    move.b     0(a0,d5.w),d0
    moveq.l    #10,d1
    lsl.l      d1,d0
    sub.l      56(a7),d0
    move.w     102(a7),d1
    sub.w      104(a7),d1
    ext.l      d1
    bsr        _ldiv
    move.l     d0,48(a7)

    lea.l      datapoint_green,a0
    moveq.l    #0,d0
    move.b     0(a0,d5.w),d0
    moveq.l    #10,d1
    lsl.l      d1,d0
    sub.l      d6,d0
    move.w     102(a7),d1
    sub.w      104(a7),d1
    ext.l      d1
    bsr        _ldiv
    move.l     d0,44(a7)

    lea.l      datapoint_blue,a0
    moveq.l    #0,d0
    move.b     0(a0,d5.w),d0
    moveq.l    #10,d1
    lsl.l      d1,d0
    sub.l      52(a7),d0
    move.w     102(a7),d1
    sub.w      104(a7),d1
    ext.l      d1
    bsr        _ldiv
    move.l     d0,d1

    move.w     104(a7),106(a7)
    bra.s      $00010C08
    move.l     56(a7),d0
    moveq.l    #10,d2
    asr.l      d2,d0
    move.b     d0,(a5)
    move.l     d6,d5
    asr.l      d2,d5
    move.b     d5,1(a5)
    move.l     52(a7),d0
    asr.l      d2,d0
    move.b     d0,2(a5)
    addq.w     #3,a5
    move.l     48(a7),d5
    add.l      d5,56(a7)
    add.l      44(a7),d6
    add.l      d1,52(a7)
    addq.w     #1,106(a7)
    move.w     106(a7),d0
    cmp.w      102(a7),d0
    blt.s      $00010BD6

    addq.w     #1,62(a7)
    moveq.l    #-1,d0
    add.w      num_datapoints,d0
    move.w     62(a7),d1
    cmp.w      d0,d1
    blt        $00010AB6

    move.l     d2,-(a7)
    move.l     d3,d0
    moveq.l    #2,d1
    bsr        _ldiv
    move.l     (a7)+,d1
    move.l     d0,d1
    add.l      d1,d1
    add.l      d0,d1
    movea.l    98(a7),a5
    adda.l     d1,a5
    lea.l      1024(a5),a5

    lea.l      112(a7),a0
    move.w     d4,d0
    bsr        _wxcnv
    lea.l      112(a7),a0
    lea.l      $00013960,a1
    bsr        _xxmul
    lea.l      112(a7),a0
    lea.l      $0001396A,a1
    bsr        __xxdiv
    lea.l      122(a7),a0
    move.l     -(a0),-(a7)
    move.l     -(a0),-(a7)
    move.w     -(a0),-(a7)
    pea.l      132(a7)
    bsr        cos
    lea.l      14(a7),a7

    lea.l      122(a7),a0
    lea.l      $00013974,a1
    bsr        _xxmul
    lea.l      122(a7),a0
    bsr        _xlcnv
    move.l     d0,d0
    move.l     d0,40(a7)

    lea.l      112(a7),a0
    move.w     d4,d0
    bsr        _wxcnv
    lea.l      112(a7),a0
    lea.l      $0001397E,a1
    bsr        _xxmul
    lea.l      112(a7),a0
    lea.l      $00013988,a1
    bsr        __xxdiv
    lea.l      122(a7),a0
    move.l     -(a0),-(a7)
    move.l     -(a0),-(a7)
    move.w     -(a0),-(a7)
    pea.l      132(a7)
    bsr        sin
    lea.l      14(a7),a7
    lea.l      122(a7),a0
    lea.l      $00013992,a1
    bsr        _xxmul
    lea.l      122(a7),a0
    bsr        _xlcnv
    move.l     d0,d0
    move.l     d0,36(a7)

    moveq.l    #0,d1
    move.l     d1,28(a7)
    move.l     d1,32(a7)
    move.l     40(a7),d0
    neg.l      d0
    move.w     310(a2),d1
    ext.l      d1
    bsr        _lmul
    asr.l      #1,d0
    move.l     d0,20(a7)

    move.l     36(a7),d0
    neg.l      d0
    move.w     312(a2),d1
    ext.l      d1
    bsr        _lmul
    asr.l      #1,d0
    move.l     d0,32(a7)

    moveq.l    #10,d1
    asr.l      d1,d0
    move.l     d0,d6
    add.l      d6,d6
    add.l      d0,d6
    moveq.l    #1,d2
    movea.l    $00013A4A,a0 maintree
    and.w      130(a0),d2
    beq        $00010E04

    clr.w      106(a7)
    bra        $00010DF4
    moveq.l    #31,d0
    and.w      106(a7),d0
    bne.s      $00010D72
    move.w     106(a7),d0
    ext.l      d0
    lsl.l      #7,d0
    move.w     312(a2),d1
    ext.l      d1
    bsr        _ldiv
    movea.l    108(a7),a0
    movea.l    82(a0),a1
    movea.l    (a1),a0
    jsr        (a0)
    move.l     20(a7),28(a7)

    move.l     d0,-(a7)
    move.w     110(a7),d0
    ext.l      d0
    move.w     310(a2),d1
    ext.l      d1
    bsr        _lmul
    move.l     (a7)+,d1
    move.l     d0,d1
    add.l      d1,d1
    add.l      d0,d1
    move.l     d1,24(a7)

    clr.w      d5
    bra.s      $00010DD4
    move.w     d5,d0
    ext.l      d0
    move.l     d0,d3
    add.l      d3,d3
    add.l      d0,d3
    add.l      24(a7),d3
    move.l     28(a7),d1
    moveq.l    #10,d2
    asr.l      d2,d1
    move.l     d1,d4
    add.l      d4,d4
    add.l      d1,d4
    add.l      d6,d4
    move.b     0(a5,d4.l),0(a3,d3.l)
    move.b     1(a5,d4.l),1(a3,d3.l)
    move.b     2(a5,d4.l),2(a3,d3.l)
    move.l     40(a7),d0
    add.l      d0,28(a7)
    addq.w     #1,d5
    cmp.w      310(a2),d5
    blt.s      $00010D9A
    move.l     36(a7),d0
    add.l      d0,32(a7)
    move.l     32(a7),d1
    moveq.l    #10,d2
    asr.l      d2,d1
    move.l     d1,d6
    add.l      d6,d6
    add.l      d1,d6
    addq.w     #1,106(a7)
    move.w     106(a7),d0
    cmp.w      312(a2),d0
    blt        $00010D4C
    bra        $00010EFC

    movea.l    98(a7),a5
    lea.l      1024(a5),a5
    clr.w      106(a7)
    bra        $00010EF0
    moveq.l    #15,d0
    and.w      106(a7),d0
    bne.s      $00010E3A
    move.w     106(a7),d0
    ext.l      d0
    lsl.l      #7,d0
    move.w     312(a2),d1
    ext.l      d1
    bsr        _ldiv
    movea.l    108(a7),a0
    movea.l    82(a0),a1
    movea.l    (a1),a0
    jsr        (a0)

    move.l     d0,-(a7)
    move.w     110(a7),d0
    ext.l      d0
    move.w     310(a2),d1
    ext.l      d1
    bsr        _lmul
    move.l     (a7)+,d1
    move.l     d0,d1
    add.l      d1,d1
    add.l      d0,d1
    move.l     d1,24(a7)

    move.w     106(a7),d0
    sub.w      $0001426A,d0 my
    ext.l      d0
    move.w     106(a7),d1
    sub.w      $0001426A,d1 my
    ext.l      d1
    bsr        _lmul
    move.l     d0,4(a7)
    move.w     $00014268,d6 mx
    ext.l      d6
    clr.w      d5
    bra.s      $00010EE6
    subq.l     #1,d6
    move.l     d6,d0
    move.l     d6,d1
    bsr        _lmul
    move.l     d0,8(a7)
    add.l      4(a7),d0
    lea.l      112(a7),a0
    bsr        _lxcnv
    lea.l      122(a7),a0
    move.l     -(a0),-(a7)
    move.l     -(a0),-(a7)
    move.w     -(a0),-(a7)
    pea.l      132(a7)
    bsr        sqrt
    lea.l      14(a7),a7

    lea.l      122(a7),a0
    bsr        _xlcnv
    move.l     d0,d0
    move.l     d0,d4
    add.l      d4,d4
    add.l      d0,d4
    move.w     d5,d0
    ext.l      d0
    move.l     d0,d3
    add.l      d3,d3
    add.l      d0,d3
    add.l      24(a7),d3
    move.b     0(a5,d4.l),0(a3,d3.l)
    move.b     1(a5,d4.l),1(a3,d3.l)
    move.b     2(a5,d4.l),2(a3,d3.l)
    addq.w     #1,d5
    cmp.w      310(a2),d5
    blt.s      $00010E84
    addq.w     #1,106(a7)
    move.w     106(a7),d0
    cmp.w      312(a2),d0
    blt        $00010E14

    movea.l    98(a7),a0
    movea.l    108(a7),a1
    movea.l    82(a1),a2
    movea.l    60(a2),a1
    jsr        (a1)
    lea.l      152(a7),a7
    movem.l    (a7)+,d3-d6/a2-a5
    rts

